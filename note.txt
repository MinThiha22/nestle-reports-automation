from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time

driver = webdriver.Chrome()  # or Firefox, Edge, etc.

try:
    # Navigate to OneDrive
    driver.get("https://onedrive.live.com/login")
    
    # Wait for and fill email field
    email_field = WebDriverWait(driver, 10).until(
        EC.presence_of_element_located((By.NAME, "loginfmt"))
    )
    email_field.send_keys("your_email@example.com")
    
    # Click Next
    next_button = driver.find_element(By.ID, "idSIButton9")
    next_button.click()
    
    # Wait for password field and fill it
    password_field = WebDriverWait(driver, 10).until(
        EC.presence_of_element_located((By.NAME, "passwd"))
    )
    password_field.send_keys("your_password")
    
    # Click Sign In
    signin_button = driver.find_element(By.ID, "idSIButton9")
    signin_button.click()
    
    # Handle potential 2FA or additional security steps
    # This is where it gets complicated...
    
except Exception as e:
    print(f"Error: {e}")
finally:
    driver.quit()